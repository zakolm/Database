###### Для разрабатываемой Вами базы данных составить, отладить и проверить 25 инструкции обработки данных, руководствуясь примерами. Для составления запроса с использованием рекурсивного обобщенного табличного выражения требуется модифицировать одну из таблиц таким образом, чтобы в этой таблице был определен внешний ключ, ссылающийся на саму таблицу.

![](https://github.com/zakolm/Database/blob/master/lab_01/Diagram.png)

1. Инструкция ```SELECT```, использующая предикат сравнения.

**Вывести все районы с рейтингом равным 2, отсортировать по имени.**

| Rang | AreaName |
|---|---|
| 2 | Академический |
| 2	| Алексеевский |
| 2	| Арбат |
| ... | ... |
| 2	| Щукино |
| 2	| Южное Бутово |
| 2	| Южное Тушино |
| 2	| Южнопортовый |

2. Инструкция ```SELECT```, использующая предикант ```BETWEEN```.

**Вывести строку сертификата и его id в категории продуктов от 1 до 5. Отсортировать по строке сертификата**

| string_sertificate | id_sertificate |
|---|---|
| HDPE | 2 |
| LDPE | 4 |
| PET |	1 |
| PP	| 5 |
| PVC	| 3 |

3. Инструкция ```SELECT```, использующий предикат ```LIKE```.

**Вывести имя района и Административный округ который находится на западе Москвы**

| AreaName | DistrictName |
|---|---|
| Очаково-Матвеевское |	ЗАО |
| Дорогомилово |	ЗАО |
| Кунцево |	ЗАО |
|...|...|
| Щукино |	СЗАО |
| Южное Тушино |	СЗАО |
| Куркино |	СЗАО |
|...|...|
| Академический |	ЮЗАО |
| Гагаринский |	ЮЗАО |
| Черёмушки |	ЮЗАО |
|...|...|
| Ясенево |	ЮЗАО | 

4. Инструкция ```SELECT```, использующая предикат ```IN``` с вложенным подзапросом.

**Вывести id и название улицы на которой находится контейнер для сортировки мусора, находящийся в районе с экологическим рейтингом равным 2**

| Id | Street |
|---|---|
| 1	| Абельмановская Застава площадь |
| 2	| Абельмановская улица |
| 3	| Абрикосовский переулок |
| 4	| Академика Петровского улица |
| 5	| Академика Сахарова проспект |
| 6	| Барыковский переулок |
| 7	| Басманный 1-й переулок |
| 8	| Басманный переулок |
| 9	| Басманный тупик |
| 10 |Бауманская 2-я улица |
|...|...|
| 141	| Колхозная улица |

5. Инструкция ```SELECT```, использующая предикат ```EXIST``` с вложеным подзапросом.

---

6. Инструкция ```SELECT```, использующая предикат сравнения с квантором.

**Вывести все названия и рейтинг районов в которых экологический рейтинг больше или равен максимальному рейтингу районов на Юго-Востоке Москвы**

| AreaName | Rang |
|---|---|
| Крылатское |	4 |
| Проспект Вернадского |	4 |
| Орехово-Борисово Северное |	4 |
|...|...|
| Троицк поселение |	4 |


7. Инструкция ```SELECT```, использующая агрегатные функции в выражениях столбцов.

**Вывести средний рейтинг в Зеленограде**

|Средний рейтинг в Зеленоград|
|---|
| 2 |

8. Инструкция ```SELECT```, использующая скалярные подзапросы в выражениях столбцов.

**Вывести улицу и район в котором находится мусорка**

| Street | Area Name |
|---|---|
| Академика Павлова улица |	Дорогомилово |
| Алябьева улица |	Дорогомилово |
| Аэрофлотская улица |	Дорогомилово |
|...|...|
| Милицейский посёлок |	Тёплый Стан |

9. Инструкция ```SELECT```, использующая простое выражение ```CASE```.

**Вывести улицу и информацию можно ли туда сдать стекло**

| Улица | Можно ли утилизировать стекло |
|---|---|
| Академика Анохина улица | 	|
| Академика Павлова улица |  |	
| Академика Петрова площадь |	Можно сдать стекло |

10. Инструкция ```SELECT```, использующая поисковое выражение ```CASE```.

**Вывести название района и по его рейтингу дать характеристику экологической ситуации там**

| Area Name | Status | 
|---|---|
| Бутырский	| Плохой |
| Вешняки |	Удовлетворительный |
| Внуково |	Хороший |
| Внуковское поселение |	Отличный |

11. Создание новой временной локальной таблицы из результирующего набора данных инструкции.

**Таблица копирует таблицу районов, без ключа связывающего таблицу с Административным округом**

| id | Area Name | Rang |
|---|---|---|
| 1	| Очаково-Матвеевское |	1 |
| 2 |	Дорогомилово	| 2 |
| 3 |	Кунцево	| 2 |

12. Инструкция ```SELECT```, использующая вложенные коррелированные подзапросы в качестве производных таблиц в предложении ```FROM```.

**Вывести улицу и что сортируемые элементы в мусорке**

| Улица | Сортируемый мусор |
|---|---|
| Абельмановская Застава площадь |	Бумага и картон/пластик, Позолоченноестекло, Пластик/белая жесть, Акрилонитрилбутадиенстирол, Никель-металл-гидридный аккумулятор, | 
| Абельмановская улица	| Пробка, | 
| Абрикосовский переулок |	Поливинилхлорид, Поливинилхлорид, Сталь, Стекло/белая жесть,  |

13. Инструкция ```SELECT```, использующая вложенные подзапросы с уровнем вложенности 3.

**Вывести районы с рейтингом равным максимальному рейтингу на ЮВАО Москвы**

| Area Name | Rang |
|---|---|
| Крылатское	| 4 |
| Проспект Вернадского |	4 |
| Орехово-Борисово Северное |	4 |

14. Инструкция ```SELECT```, консолидирующая данные с помощью предложения ```GROUP BY```, но без предложения ```HAVING```.

**Сгрупировать по району и Администротивному округу**

| Area Name | District Name |
|---|---|
| Крылатское |	ЗАО |
| Проспект Вернадского	| ЗАО | 
| Бирюлёво Западное	| ЮАО |

15. Инструкция ```SELECT```, консолидирующая данные с помощью предложения ```GROUP BY``` и предложения ```HAVING```.

**Сгрупировать по району и Администротивному округу, учитывая что рейтинг должен быть больше 2**

| Rang | Area Name | District Name |
|---|---|---|
| 4 |	Проспект Вернадского |	ЗАО |
| 3 |	Бирюлёво Восточное |	ЮАО |
| 3 |	Нагатинский Затон |	ЮАО |

16. Однострочная инструкция ```INSERT```, выполняющая вставку в таблицу одной строки значений.

---

17. Многострочная инструкция ```INSERT```, выполняющая вставку в таблицу результирующего набора данных вложенного подзапроса.

---

18. Простая инструкция ```UPDATE```.

Было:

| Id| AreaName | District | Rang |
|---|---|---|---|
| 99 | Басманный | 5 |	2 |

Стало:

| Id| AreaName | District | Rang |
|---|---|---|---|
| 99 | Басманный | 5 |	4 |

19. Инструкция ```UPDATE``` со скалярным подзапросом в предложении ```SET```.

Было:

| Id| AreaName | District | Rang |
|---|---|---|---|
| 99 | Басманный | 5 |	2 |

Стало:

| Id| AreaName | District | Rang |
|---|---|---|---|
| 99 | Басманный | 5 |	3 |

20. Простая инструкция ```DELETE```.

---

21. Инструкция ```DELETE``` с вложенным коррелированным подзапросом в предложении ```WHERE```.

---

22. Инструкция ```SELECT```, использующая простое обобщенное табличное выражение.

**Подсчет районов с разным рейтингом**

| Rang | Количество значений рейтинга |
|---|---|
| 1 |	23 |
| 2	| 53 |
| 3 |	41 |
| 4	| 29 |

23. Инструкция ```SELECT```, использующая рекурсивное обобщенное табличное выражение.

**Составить таблиу по времени и сложности разложения элементов**

| decompositionID | recyclingID | Title | Level |
|---|---|---|---|
| NULL |	1 |	Полиэтилентерефталат |	0 |
| 1	| 2	| Полиэтилен высокой плотности |	1 |
| 2	| 3	| Поливинилхлорид |	2 |
| 3 |	4	| Полиэтилен низкой плотности |	3 |

24. Оконные функции. Использование конструкций ```MIN```/```MAX```/```AVG OVER()```.

**Средний рейтинг в Административном округе**

|District Name | Avg Rang |
|---|---|
| ЗАО | 2 |
| ЗАО |	2 |
| ЗАО |	2 |
| Зеленоградский округ |	3 |
| Зеленоградский округ |	3 |

25. Оконные функции для устранения дублей

| id | Element Name | string sertificate | id sertificate | count |
|---|---|---|---|---|
| 41 |	Акрилонитрилбутадиенстирол |	ABS |	NULL |	1 |
| 11 |	Алюминий	| ALU	| 41	| 1 |
| 16 |	Бесцветное стекло |	GL |	70 |	1 |
